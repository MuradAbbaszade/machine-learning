# -*- coding: utf-8 -*-
"""loan_status_prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1rHXOoMXAZYjHCr8Ib0XM1V6AcKuMSgX7
"""

import numpy as np
import pandas as pd
from sklearn.metrics import accuracy_score
import seaborn as sb
from sklearn.model_selection import train_test_split
from sklearn import svm

"""Data processing"""

loan_data = pd.read_csv("/content/data.csv")
loan_data.replace({"Loan_Status":{"N":0,"Y":1}},inplace=True)
loan_data.replace({"Dependents":{"0":0,"1":1,"2":2,"3+":4}},inplace=True)
loan_data.replace({"Gender":{"Male":1,"Female":0},"Married":{"Yes":1,"No":0},"Education":{"Graduate":1,"Not Graduate":0},
                   "Self_Employed":{"Yes":1,"No":0},"Property_Area":{"Rural":0,"Urban":1,"Semiurban":2}},inplace=True)
loan_data = loan_data.drop(columns="Loan_ID",axis=1)
print(loan_data)

"""Drop missing values"""

loan_data.isnull().sum()
loan_data = loan_data.dropna()

"""Split data into input and label"""

X=loan_data.drop(columns="Loan_Status",axis=1)
Y=loan_data["Loan_Status"]
X.isnull().sum()

"""Split data into train and test data"""

X_train,X_test,Y_train,Y_test = train_test_split(X,Y,test_size=0.2,stratify=Y,random_state=1)

"""Model training"""

model = svm.SVC(kernel="linear")
model.fit(X_train,Y_train)

#from xgboost import XGBClassifier
#model = XGBClassifier()
#model.fit(X_train,Y_train)

"""Model testing"""

test_prediction = model.predict(X_test)
test_prediction_accuracy = accuracy_score(test_prediction,Y_test)
print(test_prediction_accuracy)

